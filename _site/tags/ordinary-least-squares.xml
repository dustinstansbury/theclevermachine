<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <title>The Clever Machine - ordinary-least-squares</title>
    <link href="/theclevermachine" rel="self"/>
    <link href="tagsordinary-least-squares.html"/>
    <updated>2023-10-12T11:40:18-07:00</updated>
    <id>/theclevermachineordinary-least-squares.html</id>

    <author>
        <name>Dustin Stansbury</name>
    </author>

    
        <entry>
            <title>Derivation: Ordinary Least Squares Solution and the Normal Equations</title>
            <link href="/theclevermachine/derivation-normal-equations"/>
            <updated>2020-07-23T00:00:00-07:00</updated>
            <id>/theclevermachine/derivation-normal-equations</id>
            <content type="html">&lt;p&gt;Have you ever performed linear regression involving multiple predictor variables and run into this expression \(\hat \beta = (X^TX)^{-1}X^Ty\)? It’s called the OLS solution via Normal Equations. To find out where it comes from, read on!&lt;/p&gt;

&lt;p&gt;In the linear regression framework, we model an output variable \(y\) (in this case a scalar) as a linear combination of some independent input variables \(X\) plus some independent noise \(\epsilon\). The linear combination of the independent variables is defined by a parameter vector \(\beta\):&lt;/p&gt;

\[y = X \beta + \epsilon\]

&lt;p&gt;We also assume that the noise term \(\epsilon\) is drawn from a Normal distribution with zero mean and a noise variance \(\sigma_{\epsilon}^2\) (generally assumed to be equal to one):&lt;/p&gt;

\[\epsilon \sim N(0,\sigma_{\epsilon}^2)\]

&lt;p&gt;For some estimate of the model parameters \(\hat \beta\), the model’s prediction errors (a.k.a. &lt;em&gt;residuals&lt;/em&gt;) \(e\) are the difference between the model prediction and the observed ouput values:&lt;/p&gt;

\[e = y - X\hat \beta\]

&lt;p&gt;The &lt;a href=&quot;http://en.wikipedia.org/wiki/Ordinary_least_squares&quot;&gt;Ordinary Least Squares (OLS) solution&lt;/a&gt; to the problem–i.e. determining an optimal solution for \(\hat \beta\)–requires minimizing the sum of the squared errors with respect to the model parameters \(\hat \beta\). It turns out, the sum of squared errors &lt;a href=&quot;https://en.wikipedia.org/wiki/Dot_product&quot;&gt;is equal to the inner product of the residuals vector with itself&lt;/a&gt; \(\sum_i e_i^2 = e^Te\) :&lt;/p&gt;

\[\begin{align}
 e^T e &amp;amp;= (y - X \hat \beta)^T (y - X \hat \beta) \\  
 &amp;amp;= y^Ty - y^T (X \hat \beta) - (X \hat \beta)^T y + (X \hat \beta)^T (X \hat \beta) \\
 &amp;amp;= y^Ty - (X \hat \beta)^T y - (X \hat \beta)^T y + (X \hat \beta)^T (X \hat \beta) \\
 &amp;amp;= y^Ty - 2(X \hat \beta)^T y + (X \hat \beta)^T (X \hat \beta) \\
 &amp;amp;= y^Ty - 2\hat \beta^T X^T y + \hat \beta^T X^T X \hat \beta \text{,} \tag{1}
\end{align}\]

&lt;p&gt;where we take advantage of the matrix identity \((AB)^T = B^TA^T\) in steps 2-3 above.&lt;/p&gt;

&lt;p&gt;To determine the parameters \(\hat \beta\) we minimize the sum of squared errors with respect to the parameters:&lt;/p&gt;

\[\begin{align}
\frac{\partial}{\partial \beta} \left[ e^T e \right] &amp;amp;= 0 \\
\frac{\partial}{\partial \beta}  \left[ y^Ty - 2\hat \beta^T X^T y + \hat \beta^T X^T X \hat \beta \right ] &amp;amp;= 0 \;\; \text{, via Eq. (1)}\\
-2X^Ty + 2X^TX \hat \beta &amp;amp;= 0 \\ 
-X^Ty + X^TX \hat \beta &amp;amp;= 0 \\ 
X^TX \hat \beta&amp;amp;= X^Ty  \text{,} \tag{2}

\end{align}\]

&lt;p&gt;where we note to the matrix derivative identity \(\frac{\partial \mathbf{a}^T \mathbf{b}}{\partial \mathbf{a}} = \mathbf{b}\), for vectors \(\mathbf{a}\) and \(\mathbf{b}\) in step 2-3 above.&lt;/p&gt;

&lt;p&gt;The relationship in &lt;strong&gt;&lt;em&gt;Equation 2&lt;/em&gt;&lt;/strong&gt; is the matrix form of what are known as the &lt;a href=&quot;https://mathworld.wolfram.com/NormalEquation.html&quot;&gt;Normal Equations&lt;/a&gt;. Solving for \(\hat \beta\) gives the analytical solution to the Ordinary Least Squares problem.&lt;/p&gt;

\[\hat \beta = (X^TX)^{-1}X^Ty\]

&lt;p&gt;…and voila!&lt;/p&gt;

&lt;hr /&gt;
&lt;hr /&gt;
&lt;h1 id=&quot;notes&quot;&gt;Notes&lt;/h1&gt;
&lt;p&gt;This post is a refactor of content with the same title originally posted on &lt;a href=&quot;https://theclevermachine.wordpress.com/2012/09/01/derivation-of-ols-normal-equations/&quot;&gt;The Clever Machine Wordpress blog&lt;/a&gt;.&lt;/p&gt;
</content>
        </entry>
    
</feed>
